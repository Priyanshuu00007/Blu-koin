<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Webcrumbs Plugin</title>
    <style>
      @import url(https://fonts.googleapis.com/css2?family=Lato&display=swap);
@import url(https://fonts.googleapis.com/css2?family=Open+Sans&display=swap);
@import url(https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined);

      /* Prevent initial flash before scripts initialize */
      #webcrumbs { visibility: hidden; }
    </style>
  </head>
  <body>
<div id="webcrumbs"><div class="min-h-screen bg-gradient-to-br from-[#ECFDF5] to-[#F0F9FF] font-sans">  <aside class="fixed top-0 left-0 z-10 h-full w-64 bg-white/80 backdrop-blur-md border-r border-slate-200 transition-all duration-300 transform lg:translate-x-0 -translate-x-full shadow-xl"> <div class="p-4 border-b border-slate-200"> <div class="flex items-center"> <div class="w-10 h-10 rounded-xl bg-gradient-to-r from-[#00C2A8] to-[#3B82F6] flex items-center justify-center"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path> </svg> </div> <h1 class="ml-3 font-bold text-slate-800 text-xl">Blu-koin</h1> </div> </div> <nav class="p-4"> <ul class="space-y-2"> <li> <a href="#" class="flex items-center p-2 rounded-lg text-slate-800 hover:bg-slate-100 transition-all group"> <span class="material-symbols-outlined mr-3 text-slate-600 group-hover:text-[#00C2A8]">dashboard</span> <span>Dashboard</span> </a> </li> <li> <a href="#" class="flex items-center p-2 rounded-lg text-slate-800 hover:bg-slate-100 transition-all group"> <span class="material-symbols-outlined mr-3 text-slate-600 group-hover:text-[#00C2A8]">landscape</span> <span>My Projects</span> </a> </li> <li> <a href="#" class="flex items-center p-2 rounded-lg text-slate-800 hover:bg-slate-100 transition-all group"> <span class="material-symbols-outlined mr-3 text-slate-600 group-hover:text-[#00C2A8]">verified</span> <span>Verification</span> </a> </li> <li> <a href="#" class="flex items-center p-2 rounded-lg text-slate-800 hover:bg-slate-100 transition-all group"> <span class="material-symbols-outlined mr-3 text-slate-600 group-hover:text-[#00C2A8]">analytics</span> <span>MRV &amp; Analytics</span> </a> </li> <li> <a href="#" class="flex items-center p-2 rounded-lg text-slate-800 hover:bg-slate-100 transition-all group"> <span class="material-symbols-outlined mr-3 text-slate-600 group-hover:text-[#00C2A8]">token</span> <span>Marketplace</span> </a> </li> </ul> <div class="mt-8 pt-4 border-t border-slate-200"> <ul class="space-y-2"> <li> <a href="app.html#/settings" class="flex items-center p-2 rounded-lg text-slate-800 hover:bg-slate-100 transition-all group"> <span class="material-symbols-outlined mr-3 text-slate-600 group-hover:text-[#00C2A8]">settings</span> <span>Settings</span> </a> </li> <li> <a href="app.html#/support" class="flex items-center p-2 rounded-lg text-slate-800 hover:bg-slate-100 transition-all group"> <span class="material-symbols-outlined mr-3 text-slate-600 group-hover:text-[#00C2A8]">help</span> <span>Support</span> </a> </li> </ul> </div> </nav> <div class="absolute bottom-0 left-0 right-0 p-4"> <div class="flex items-center p-3 rounded-xl bg-gradient-to-r from-[#ECFDF5] to-[#EFF6FF]"> <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center shadow-sm"> <span class="material-symbols-outlined text-[#00C2A8]">person</span> </div> <div class="ml-3"> <p class="text-sm font-medium text-slate-800" id="sidebarUserName">Alex Thompson</p> <p class="text-xs text-slate-500">Project Developer</p> </div> </div> </div> </aside>  <header class="lg:hidden fixed top-0 left-0 right-0 bg-white/80 backdrop-blur-md z-10 border-b border-slate-200 py-3 px-4"> <div class="flex justify-between items-center"> <button class="p-2 rounded-lg hover:bg-slate-100"> <span class="material-symbols-outlined">menu</span> </button> <div class="flex items-center"> <div class="w-8 h-8 rounded-xl bg-gradient-to-r from-[#00C2A8] to-[#3B82F6] flex items-center justify-center"> <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path> </svg> </div> <h1 class="ml-2 font-bold text-slate-800 text-lg">Blu-koin</h1> </div> <button class="p-2 rounded-lg hover:bg-slate-100"> <span class="material-symbols-outlined">notifications</span> </button> </div> </header>  <main class="lg:pl-64 pt-4 lg:pt-0 pb-20">  <header class="hidden lg:block sticky top-0 bg-white/80 backdrop-blur-md border-b border-slate-200 px-8 py-4 z-10"> <div class="flex justify-between items-center"> <div class="flex items-center"> <h2 class="text-2xl font-bold text-slate-800">Dashboard</h2> <div class="ml-8 flex items-center bg-slate-100 rounded-lg p-1"> <button class="px-4 py-2 rounded-md bg-white text-sm font-medium shadow-sm">Project Developer</button> <button class="px-4 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-slate-800">Verifier</button> <button class="px-4 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-slate-800">Buyer</button> </div> </div> <div class="flex items-center"> <button class="p-2 rounded-full hover:bg-slate-100 mr-2"> <span class="material-symbols-outlined">search</span> </button> <div class="relative"> <button class="p-2 rounded-full hover:bg-slate-100 mr-2"> <span class="material-symbols-outlined">notifications</span> <span class="absolute top-1 right-1 w-2 h-2 bg-[#FF7EB3] rounded-full"></span> </button> </div> <button class="p-2 rounded-full hover:bg-slate-100 mr-4"> <span class="material-symbols-outlined">help</span> </button> <div class="h-8 w-8 rounded-full bg-gradient-to-r from-[#00C2A8] to-[#3B82F6] flex items-center justify-center text-white text-sm font-bold" id="avatarInitials">AT</div> </div> </div> </header> <div class="px-4 md:px-8 py-6">  <div class="mb-8"> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"> <div class="bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow border border-slate-200 group hover:border-[#00C2A8]"> <div class="flex items-center justify-between mb-4"> <h3 class="text-sm font-medium text-slate-500">Total Projects</h3> <span class="p-2 bg-[#ECFDF5] rounded-full text-[#16A34A] group-hover:bg-[#16A34A] group-hover:text-white transition-colors"> <span class="material-symbols-outlined text-lg">landscape</span> </span> </div> <p class="text-3xl font-bold text-slate-800">143</p> <p class="text-sm font-medium text-[#16A34A] flex items-center mt-2"> <span class="material-symbols-outlined text-sm mr-1">arrow_upward</span> 12% this month </p> </div> <div class="bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow border border-slate-200 group hover:border-[#00C2A8]"> <div class="flex items-center justify-between mb-4"> <h3 class="text-sm font-medium text-slate-500">Verified Credits</h3> <span class="p-2 bg-[#EFF6FF] rounded-full text-[#3B82F6] group-hover:bg-[#3B82F6] group-hover:text-white transition-colors"> <span class="material-symbols-outlined text-lg">verified</span> </span> </div> <p class="text-3xl font-bold text-slate-800">1.2M</p> <p class="text-sm font-medium text-[#3B82F6] flex items-center mt-2"> <span class="material-symbols-outlined text-sm mr-1">arrow_upward</span> 8% this month </p> </div> <div class="bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow border border-slate-200 group hover:border-[#00C2A8]"> <div class="flex items-center justify-between mb-4"> <h3 class="text-sm font-medium text-slate-500">CO₂ Offset (tons)</h3> <span class="p-2 bg-[#FEF2F2] rounded-full text-[#FF7EB3] group-hover:bg-[#FF7EB3] group-hover:text-white transition-colors"> <span class="material-symbols-outlined text-lg">co2</span> </span> </div> <p class="text-3xl font-bold text-slate-800">856,432</p> <p class="text-sm font-medium text-[#FF7EB3] flex items-center mt-2"> <span class="material-symbols-outlined text-sm mr-1">arrow_upward</span> 15% this month </p> </div> <div class="bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow border border-slate-200 group hover:border-[#00C2A8]"> <div class="flex items-center justify-between mb-4"> <h3 class="text-sm font-medium text-slate-500">Marketplace Volume</h3> <span class="p-2 bg-[#F8FAFC] rounded-full text-[#64748B] group-hover:bg-[#64748B] group-hover:text-white transition-colors"> <span class="material-symbols-outlined text-lg">payments</span> </span> </div> <p class="text-3xl font-bold text-slate-800">₹4.2M</p> <p class="text-sm font-medium text-[#64748B] flex items-center mt-2"> <span class="material-symbols-outlined text-sm mr-1">arrow_upward</span> 6% this month </p> </div> </div> <div class="grid grid-cols-1 lg:grid-cols-3 gap-6"> <div class="lg:col-span-2 bg-white rounded-xl p-6 shadow-sm border border-slate-200"> <div class="flex justify-between items-center mb-6"> <h3 class="font-medium text-slate-800">Carbon Credits Over Time</h3> <div class="flex space-x-2"> <button class="px-3 py-1 text-xs font-medium rounded-md bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors">1M</button> <button class="px-3 py-1 text-xs font-medium rounded-md bg-[#00C2A8] text-white">3M</button> <button class="px-3 py-1 text-xs font-medium rounded-md bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors">6M</button> <button class="px-3 py-1 text-xs font-medium rounded-md bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors">1Y</button> </div> </div> <div class="h-64 w-full">  <div class="h-full w-full bg-gradient-to-b from-[#ECFDF5]/30 to-transparent rounded-lg flex items-end relative"> <div class="absolute top-0 left-0 right-0 h-[1px] bg-[#00C2A8]/20"></div> <div class="absolute top-1/4 left-0 right-0 h-[1px] bg-[#00C2A8]/20"></div> <div class="absolute top-1/2 left-0 right-0 h-[1px] bg-[#00C2A8]/20"></div> <div class="absolute top-3/4 left-0 right-0 h-[1px] bg-[#00C2A8]/20"></div> <div class="w-1/12 h-[30%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[45%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[38%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[60%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[52%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[70%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[65%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[48%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[72%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[85%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[78%] bg-[#00C2A8]/70 rounded-t"></div> <div class="w-1/12 h-[90%] bg-[#00C2A8]/70 rounded-t"></div> </div>  </div> </div> <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200"> <div class="flex justify-between items-center mb-6"> <h3 class="font-medium text-slate-800">Project Locations</h3> <button class="p-1 rounded-md hover:bg-slate-100 text-slate-600"> <span class="material-symbols-outlined text-sm">more_horiz</span> </button> </div> <div class="h-64 bg-[#F8FAFC] rounded-lg overflow-hidden relative">  <div class="absolute inset-0 bg-[url(&#x27;https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=M3w3MzkyNDZ8MHwxfHNlYXJjaHwxfHxhYnN0cmFjdHxlbnwwfHx8fDE3NTg4NDU0MzN8MA&amp;ixlib=rb-4.1.0&amp;q=80&amp;w=1080&#x27;)] bg-cover bg-center opacity-30"></div> <div class="absolute top-1/4 left-1/4 w-3 h-3 bg-[#16A34A] rounded-full animate-ping"></div> <div class="absolute top-1/4 left-1/4 w-2 h-2 bg-[#16A34A] rounded-full shadow-lg"></div> <div class="absolute top-1/2 left-2/3 w-3 h-3 bg-[#3B82F6] rounded-full animate-ping animation-delay-300"></div> <div class="absolute top-1/2 left-2/3 w-2 h-2 bg-[#3B82F6] rounded-full shadow-lg"></div> <div class="absolute top-3/5 left-1/3 w-3 h-3 bg-[#00C2A8] rounded-full animate-ping animation-delay-700"></div> <div class="absolute top-3/5 left-1/3 w-2 h-2 bg-[#00C2A8] rounded-full shadow-lg"></div> <div class="absolute top-1/3 left-3/4 w-3 h-3 bg-[#FF7EB3] rounded-full animate-ping animation-delay-500"></div> <div class="absolute top-1/3 left-3/4 w-2 h-2 bg-[#FF7EB3] rounded-full shadow-lg"></div>  </div> <div class="mt-4 flex flex-wrap items-center justify-between gap-3"> <div class="flex flex-wrap items-center gap-3"> <div class="flex items-center"> <span class="w-2 h-2 rounded-full bg-[#16A34A] mr-2"></span> <span class="text-xs text-slate-600">Mangroves</span> </div> <div class="flex items-center"> <span class="w-2 h-2 rounded-full bg-[#3B82F6] mr-2"></span> <span class="text-xs text-slate-600">Seagrass</span> </div> </div> <div class="flex flex-wrap items-center gap-3"> <div class="flex items-center"> <span class="w-2 h-2 rounded-full bg-[#00C2A8] mr-2"></span> <span class="text-xs text-slate-600">Salt Marsh</span> </div> <div class="flex items-center"> <span class="w-2 h-2 rounded-full bg-[#FF7EB3] mr-2"></span> <span class="text-xs text-slate-600">Wetlands</span> </div> </div> </div> </div> </div> </div>  <div class="mb-8"> <div class="flex justify-between items-center mb-6"> <h2 class="text-xl font-bold text-slate-800">My Projects</h2> <button id="registerProjectBtn" class="px-4 py-2 bg-gradient-to-r from-[#00C2A8] to-[#3B82F6] text-white font-medium rounded-lg hover:shadow-md transform hover:translate-y-[-1px] transition-all flex items-center"> <span class="material-symbols-outlined mr-2">add</span> Register New Project </button> </div> <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden"> <div class="p-4 border-b border-slate-200 flex justify-between items-center"> <div class="flex space-x-2"> <button class="px-3 py-1 text-sm font-medium rounded-md bg-[#00C2A8] text-white">All</button> <button class="px-3 py-1 text-sm font-medium rounded-md bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors">Draft</button> <button class="px-3 py-1 text-sm font-medium rounded-md bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors">Submitted</button> <button class="px-3 py-1 text-sm font-medium rounded-md bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors">Verified</button> </div> <div class="flex items-center"> <div class="relative mr-4"> <span class="material-symbols-outlined absolute left-3 top-2 text-slate-400">search</span> <input type="text" placeholder="Search projects" class="pl-10 pr-4 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-[#00C2A8]/50 focus:border-[#00C2A8] text-sm"/> </div> <button class="p-2 rounded-md hover:bg-slate-100 text-slate-600"> <span class="material-symbols-outlined">filter_list</span> </button> </div> </div> <table class="w-full"> <thead class="bg-slate-50"> <tr> <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Project Name</th> <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Ecosystem</th> <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Location</th> <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Status</th> <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Credits</th> <th class="px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider">Actions</th> </tr> </thead> <tbody id="projectsTbody" class="divide-y divide-slate-200 bg-white"> <!-- rows injected --> </tbody></table></div></div></div></main></div></div>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // Dashboard functionality
      document.addEventListener('DOMContentLoaded', function() {
        // Check if user is logged in (simple check)
        const isLoggedIn = localStorage.getItem('userLoggedIn');
        if (!isLoggedIn) {
          // Redirect to login if not logged in
          window.location.href = 'login.html';
          return;
        }

        // Add logout functionality
        const logoutButton = document.createElement('button');
        logoutButton.innerHTML = '<span class="material-symbols-outlined mr-2">logout</span>Logout';
        logoutButton.className = 'px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center';
        logoutButton.onclick = function() {
          localStorage.removeItem('userLoggedIn');
          localStorage.removeItem('userAction');
          window.location.href = 'landing page.html';
        };

        // Add logout button to the header
        const headerActions = document.querySelector('header .flex.items-center');
        if (headerActions) {
          headerActions.appendChild(logoutButton);
        }

        // Add back to home functionality
        const homeButton = document.createElement('button');
        homeButton.innerHTML = '<span class="material-symbols-outlined mr-2">home</span>Home';
        homeButton.className = 'px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center mr-2';
        homeButton.onclick = function() {
          window.location.href = 'landing page.html';
        };

        // Add home button to the header
        if (headerActions) {
          headerActions.insertBefore(homeButton, logoutButton);
        }

        // Add role switching functionality
        // Wait for DOM to be fully loaded
        setTimeout(() => {
          // Find all buttons and add click handlers
          const allButtons = document.querySelectorAll('button');
          console.log('Found buttons:', allButtons.length);
          
          allButtons.forEach((button, index) => {
            console.log(`Button ${index}:`, button.textContent.trim());
            if (button.textContent.includes('Verifier')) {
              button.onclick = function(e) {
                e.preventDefault();
                console.log('Verifier button clicked!');
                window.location.href = 'verifier-dashboard.html';
              };
              button.style.cursor = 'pointer';
              button.style.backgroundColor = '#f1f5f9';
              console.log('Verifier button configured');
            } else if (button.textContent.includes('Buyer')) {
              button.onclick = function(e) {
                e.preventDefault();
                console.log('Buyer button clicked!');
                window.location.href = 'buyer-dashboard.html';
              };
              button.style.cursor = 'pointer';
              button.style.backgroundColor = '#f1f5f9';
              console.log('Buyer button configured');
            }
          });
        }, 1000);

        // Add marketplace link functionality
        const marketplaceLinks = document.querySelectorAll('a[href="#"]');
        marketplaceLinks.forEach(link => {
          if (link.textContent.includes('Marketplace')) {
            link.href = 'marketplace.html';
            link.onclick = function(e) {
              e.preventDefault();
              window.location.href = 'marketplace.html';
            };
          }
        });

        // Upgrade the Carbon Credits chart UI with Chart.js
        try {
          const chartSection = document.querySelector('.lg\\:col-span-2.bg-white.rounded-xl.p-6.shadow-sm.border.border-slate-200');
          if (chartSection) {
            const rangeContainer = chartSection.querySelector('.flex.space-x-2');
            if (rangeContainer) {
              rangeContainer.classList.add('credits-range');
              rangeContainer.querySelectorAll('button').forEach(btn => btn.classList.add('range-btn'));
            }
            const plotHolder = chartSection.querySelector('.h-64.w-full');
            if (plotHolder) {
              plotHolder.innerHTML = '<canvas id="creditsChart"></canvas>';
            }
            setupCreditsChart();
          }
        } catch (err) {
          console.warn('Chart init failed', err);
        }

        // Reveal UI after initialization completes
        const appRoot = document.getElementById('webcrumbs');
        if (appRoot) appRoot.style.visibility = 'visible';
      });

      // Chart.js configuration for credits over time
      let creditsChart;
      const creditsDatasets = {
        '1M': Array.from({length: 4}, (_, i) => 400 + Math.round(100*Math.sin(i+1)) + i*40),
        '3M': Array.from({length: 12}, (_, i) => 380 + ((i%3)*60) + i*15),
        '6M': Array.from({length: 24}, (_, i) => 300 + ((i%4)*40) + i*10),
        '1Y': Array.from({length: 12}, (_, i) => 300 + (i%5)*50 + i*20)
      };

      function setupCreditsChart() {
        const canvas = document.getElementById('creditsChart');
        if (!canvas || !window.Chart) return;
        const ctx = canvas.getContext('2d');

        const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
        gradient.addColorStop(0, 'rgba(0, 194, 168, 0.35)');
        gradient.addColorStop(1, 'rgba(0, 194, 168, 0.02)');

        const initialRange = '3M';
        creditsChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: Array.from({length: creditsDatasets[initialRange].length}, (_, i) => ''),
            datasets: [{
              data: creditsDatasets[initialRange],
              fill: true,
              backgroundColor: gradient,
              borderColor: '#00C2A8',
              borderWidth: 2,
              tension: 0.35,
              pointRadius: 0,
              segment: { borderColor: '#00C2A8' }
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: '#0f172a',
                borderColor: '#00C2A8',
                borderWidth: 1,
                titleColor: '#fff',
                bodyColor: '#e2e8f0',
                displayColors: false,
                callbacks: { label: (ctx) => `${ctx.parsed.y.toLocaleString()} credits` }
              }
            },
            scales: {
              x: { grid: { display: false }, ticks: { display: false } },
              y: { grid: { color: 'rgba(0,194,168,0.15)' }, ticks: { color: '#94a3b8' } }
            }
          }
        });

        document.querySelectorAll('.range-btn').forEach(btn => {
          btn.addEventListener('click', () => setCreditsRange(btn.dataset.range, btn));
        });
      }

      function setCreditsRange(rangeKey, activeBtn) {
        if (!creditsChart || !creditsDatasets[rangeKey]) return;
        const data = creditsDatasets[rangeKey];
        creditsChart.data.labels = Array.from({length: data.length}, (_, i) => '');
        creditsChart.data.datasets[0].data = data;
        creditsChart.update();
        document.querySelectorAll('.range-btn').forEach(b => { b.classList.remove('bg-[#00C2A8]','text-white'); b.classList.add('bg-slate-100','text-slate-600'); });
        if (activeBtn) { activeBtn.classList.remove('bg-slate-100','text-slate-600'); activeBtn.classList.add('bg-[#00C2A8]','text-white'); }
      }

      // Role switching functions
      function switchRole(role) {
        localStorage.setItem('userRole', role);
        if (role === 'verifier') {
          window.location.href = 'verifier-dashboard.html';
        } else if (role === 'buyer') {
          window.location.href = 'buyer-dashboard.html';
        }
      }

      // Global click handler for role buttons
      document.addEventListener('click', function(e) {
        if (e.target.textContent && e.target.textContent.includes('Verifier')) {
          e.preventDefault();
          console.log('Verifier clicked via global handler');
          window.location.href = 'verifier-dashboard.html';
        } else if (e.target.textContent && e.target.textContent.includes('Buyer')) {
          e.preventDefault();
          console.log('Buyer clicked via global handler');
          window.location.href = 'buyer-dashboard.html';
        }
      });

      tailwind.config = {
        content: ["./src/**/*.{html,js}"],
        theme: {"name":"Bluewave","fontFamily":{"sans":["Open Sans","ui-sans-serif","system-ui","sans-serif","\"Apple Color Emoji\"","\"Segoe UI Emoji\"","\"Segoe UI Symbol\"","\"Noto Color Emoji\""]},"extend":{"fontFamily":{"title":["Lato","ui-sans-serif","system-ui","sans-serif","\"Apple Color Emoji\"","\"Segoe UI Emoji\"","\"Segoe UI Symbol\"","\"Noto Color Emoji\""],"body":["Open Sans","ui-sans-serif","system-ui","sans-serif","\"Apple Color Emoji\"","\"Segoe UI Emoji\"","\"Segoe UI Symbol\"","\"Noto Color Emoji\""]},"colors":{"neutral":{"50":"#f7f7f7","100":"#eeeeee","200":"#e0e0e0","300":"#cacaca","400":"#b1b1b1","500":"#999999","600":"#7f7f7f","700":"#676767","800":"#545454","900":"#464646","950":"#282828"},"primary":{"50":"#f3f1ff","100":"#e9e5ff","200":"#d5cfff","300":"#b7a9ff","400":"#9478ff","500":"#7341ff","600":"#631bff","700":"#611bf8","800":"#4607d0","900":"#3c08aa","950":"#220174","DEFAULT":"#611bf8"}}},"fontSize":{"xs":["12px",{"lineHeight":"19.200000000000003px"}],"sm":["14px",{"lineHeight":"21px"}],"base":["16px",{"lineHeight":"25.6px"}],"lg":["18px",{"lineHeight":"27px"}],"xl":["20px",{"lineHeight":"28px"}],"2xl":["24px",{"lineHeight":"31.200000000000003px"}],"3xl":["30px",{"lineHeight":"36px"}],"4xl":["36px",{"lineHeight":"41.4px"}],"5xl":["48px",{"lineHeight":"52.800000000000004px"}],"6xl":["60px",{"lineHeight":"66px"}],"7xl":["72px",{"lineHeight":"75.60000000000001px"}],"8xl":["96px",{"lineHeight":"100.80000000000001px"}],"9xl":["128px",{"lineHeight":"134.4px"}]},"borderRadius":{"none":"0px","sm":"6px","DEFAULT":"12px","md":"18px","lg":"24px","xl":"36px","2xl":"48px","3xl":"72px","full":"9999px"},"spacing":{"0":"0px","1":"4px","2":"8px","3":"12px","4":"16px","5":"20px","6":"24px","7":"28px","8":"32px","9":"36px","10":"40px","11":"44px","12":"48px","14":"56px","16":"64px","20":"80px","24":"96px","28":"112px","32":"128px","36":"144px","40":"160px","44":"176px","48":"192px","52":"208px","56":"224px","60":"240px","64":"256px","72":"288px","80":"320px","96":"384px","px":"1px","0.5":"2px","1.5":"6px","2.5":"10px","3.5":"14px"}},
        plugins: [],
        important: '#webcrumbs'
    };
    </script>

  </body>
</html>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    try {
      const cards = Array.from(document.querySelectorAll('.bg-white.rounded-xl.p-6.shadow-sm.border.border-slate-200'));
      const locationCard = cards.find(c => c.querySelector('h3') && c.querySelector('h3').textContent.trim() === 'Project Locations');
      if (!locationCard) return;
      const heightBlocks = locationCard.querySelectorAll('.h-64');
      if (!heightBlocks || !heightBlocks.length) return;
      const host = heightBlocks[0];
      host.innerHTML = '<div id="projectMap" style="height:100%; width:100%;"></div>';
      ensureLeaflet().then(initProjectMap);
    } catch (e) {
      console.warn('Failed to initialize Leaflet map', e);
    }
  });

  function ensureLeaflet() {
    return new Promise((resolve) => {
      if (window.L && window.L.map) { resolve(); return; }
      const link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';
      document.head.appendChild(link);
      const script = document.createElement('script');
      script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
      script.onload = () => resolve();
      document.body.appendChild(script);
    });
  }

  function initProjectMap() {
    if (!window.L) return;
    const mapEl = document.getElementById('projectMap');
    if (!mapEl) return;
    const map = L.map(mapEl, { zoomControl: true, attributionControl: false });
    map.setView([21.5, 78.9], 5);

    // Aesthetic light basemap
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      maxZoom: 20
    }).addTo(map);

    const points = [
      { name: 'Sundarbans Mangrove', coords: [21.9497, 88.7105], color: '#16A34A', type: 'Mangroves' },
      { name: 'Gulf of Mannar Seagrass', coords: [9.25, 79.15], color: '#3B82F6', type: 'Seagrass' },
      { name: 'Chilika Lake Wetlands', coords: [19.754, 85.006], color: '#FF7EB3', type: 'Wetlands' },
      { name: 'Salt Marsh (Kutch)', coords: [23.733, 69.859], color: '#00C2A8', type: 'Salt Marsh' }
    ];

    points.forEach(p => {
      const marker = L.circleMarker(p.coords, {
        radius: 8,
        color: p.color,
        weight: 2,
        fillColor: p.color,
        fillOpacity: 0.25
      }).addTo(map);
      marker.bindPopup(`<div style=\"min-width:160px\"><strong>${p.name}</strong><br/><span style=\"color:#64748B\">${p.type}</span></div>`);
    });

    setTimeout(() => map.invalidateSize(), 300);
  }
</script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    try {
      const name = (localStorage.getItem('userName') || '').trim();
      const email = (localStorage.getItem('userEmail') || '').trim();
      const displayName = name || (email ? email.split('@')[0] : '');
      if (displayName) {
        const sidebarNameEl = document.getElementById('sidebarUserName');
        if (sidebarNameEl) sidebarNameEl.textContent = displayName;
        const initialsEl = document.getElementById('avatarInitials');
        if (initialsEl) {
          const initials = displayName
            .split(/\s+/)
            .filter(Boolean)
            .slice(0, 2)
            .map(s => s.charAt(0).toUpperCase())
            .join('') || 'U';
          initialsEl.textContent = initials;
        }
      }
    } catch (e) {
      console.warn('Failed to apply user display name', e);
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Wire Register New Project
    const btn = document.getElementById('registerProjectBtn');
    if (btn) {
      btn.addEventListener('click', function(e){
        e.preventDefault();
        window.location.href = 'project-register.html';
      });
    }

    // Seed mock projects once if none exist
    try {
      const key = 'userProjects';
      const current = JSON.parse(localStorage.getItem(key) || '[]');
      if (!current || current.length === 0) {
        const seed = [
          { id: 'BCRA-9001', name: 'Kutch Salt Marsh Restoration', ecosystem: 'Salt Marsh', location: 'Kutch, India', status: 'Submitted', credits: 42500, description: 'Community-led salt marsh restoration.' },
          { id: 'BCRA-9002', name: 'Andaman Seagrass Revival', ecosystem: 'Seagrass', location: 'Andaman & Nicobar, India', status: 'Draft', credits: 18000, description: 'Seagrass meadow restoration pilot.' }
        ];
        localStorage.setItem(key, JSON.stringify(seed));
      }
    } catch (e) { console.warn('Seeding projects failed', e); }

    // Render projects from localStorage
    try {
      const tbody = document.getElementById('projectsTbody');
      if (tbody) {
        const stored = JSON.parse(localStorage.getItem('userProjects') || '[]');
        const defaultRowsHtml = tbody.innerHTML && tbody.innerHTML.trim().length > 0 ? tbody.innerHTML : '';
        const rows = (stored || []).map(p => {
          const badgeColor = p.ecosystem === 'Seagrass' ? 'blue' : p.ecosystem === 'Salt Marsh' ? 'emerald' : p.ecosystem === 'Wetlands' ? 'pink' : 'green';
          const statusColor = p.status === 'Verified' ? 'blue' : p.status === 'Submitted' ? 'yellow' : p.status === 'Draft' ? 'slate' : 'gray';
          return `
            <tr class="hover:bg-slate-50 transition-colors">
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div class="w-8 h-8 rounded-md bg-[#ECFDF5] flex items-center justify-center text-[#16A34A] mr-3">
                    <span class="material-symbols-outlined">landscape</span>
                  </div>
                  <div>
                    <p class="text-sm font-medium text-slate-800">${p.name}</p>
                    <p class="text-xs text-slate-500">ID: ${p.id}</p>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-${badgeColor}-100 text-${badgeColor}-800"> ${p.ecosystem} </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600"> ${p.location} </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2.5 py-0.5 rounded-full text-xs font-medium bg-${statusColor}-100 text-${statusColor}-800"> ${p.status} </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-800"> ${Number(p.credits||0).toLocaleString()} </td>
              <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                <div class="flex justify-end space-x-2">
                  <button class="p-1.5 rounded-md text-slate-600 hover:bg-slate-100"><span class="material-symbols-outlined text-sm">visibility</span></button>
                  <button class="p-1.5 rounded-md text-slate-600 hover:bg-slate-100"><span class="material-symbols-outlined text-sm">edit</span></button>
                </div>
              </td>
            </tr>`;
        }).join('');
        const staticSection = document.querySelector('tbody.divide-y.divide-slate-200.bg-white');
        if (staticSection) {
          tbody.innerHTML = rows + defaultRowsHtml;
        }
        const just = localStorage.getItem('projectJustAdded');
        if (just) {
          localStorage.removeItem('projectJustAdded');
          alert(`Project "${just}" added successfully!`);
        }
      }
      // Update Total Projects KPI
      const kpiEls = Array.from(document.querySelectorAll('.bg-white.rounded-xl.p-6.shadow-sm'));
      const totalProjectsCard = kpiEls.find(el => el.querySelector('h3') && el.querySelector('h3').textContent.includes('Total Projects'));
      if (totalProjectsCard) {
        const pCount = (JSON.parse(localStorage.getItem('userProjects')||'[]')||[]).length + 143;
        const pEl = totalProjectsCard.querySelector('p.text-3xl');
        if (pEl) pEl.textContent = pCount.toLocaleString();
      }
    } catch (err) {
      console.warn('Failed to render stored projects', err);
    }
  });
</script>