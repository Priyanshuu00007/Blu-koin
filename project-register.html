<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Register New Project - Blu-koin</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
	<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-[#ECFDF5] to-[#F0F9FF] font-[Open_Sans] text-slate-800">
	<div class="max-w-3xl mx-auto p-6">
		<div class="flex items-center justify-between mb-6">
			<h1 class="text-2xl font-bold">Register New Project</h1>
			<a href="dashboard.html" class="px-4 py-2 rounded-lg bg-slate-100 hover:bg-slate-200">Cancel</a>
		</div>
		<form id="projectForm" class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 space-y-5">
			<div>
				<label class="block text-sm font-medium mb-1">Project Name</label>
				<input name="name" required placeholder="e.g. Sundarbans Mangrove" class="w-full px-3 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-[#00C2A8]/50" />
			</div>
			<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
				<div>
					<label class="block text-sm font-medium mb-1">Ecosystem</label>
					<select name="ecosystem" required class="w-full px-3 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-[#00C2A8]/50">
						<option value="Mangrove">Mangrove</option>
						<option value="Seagrass">Seagrass</option>
						<option value="Salt Marsh">Salt Marsh</option>
						<option value="Wetlands">Wetlands</option>
					</select>
				</div>
				<div>
					<label class="block text-sm font-medium mb-1">Estimated Credits</label>
					<input name="credits" type="number" min="0" step="1" required placeholder="e.g. 25000" class="w-full px-3 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-[#00C2A8]/50" />
				</div>
			</div>
			<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
				<div>
					<label class="block text-sm font-medium mb-1">Country/Region</label>
					<input name="location" required placeholder="e.g. West Bengal, India" class="w-full px-3 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-[#00C2A8]/50" />
				</div>
				<div>
					<label class="block text-sm font-medium mb-1">Status</label>
					<select name="status" class="w-full px-3 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-[#00C2A8]/50">
						<option value="Submitted">Submitted</option>
						<option value="Draft">Draft</option>
					</select>
				</div>
			</div>
			<div>
				<label class="block text-sm font-medium mb-1">Description</label>
				<textarea name="description" rows="4" placeholder="Brief description of the project" class="w-full px-3 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-[#00C2A8]/50"></textarea>
			</div>
			<div>
				<label class="block text-sm font-medium mb-1">Upload Documents (PDF/Images/Docs)</label>
				<input id="docsInput" name="documents" type="file" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.tif,.tiff" class="w-full px-3 py-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-[#00C2A8]/50 bg-slate-50" />
			</div>
			<button type="submit" class="px-5 py-2.5 rounded-lg bg-gradient-to-r from-[#00C2A8] to-[#3B82F6] text-white font-medium hover:shadow-md">Save Project</button>
		</form>
		<p id="note" class="text-sm text-slate-500 mt-4">Saved projects appear instantly on your dashboard.</p>
	</div>
	<script>
		document.getElementById('projectForm').addEventListener('submit', function(e) {
			e.preventDefault();
			const form = e.target;
			const data = Object.fromEntries(new FormData(form));
			const projectsKey = 'userProjects';
			const existing = JSON.parse(localStorage.getItem(projectsKey) || '[]');
			const idNum = Date.now();
			const id = `BCRA-${idNum.toString().slice(-4)}`;
			const credits = Math.max(0, parseInt(data.credits || '0', 10) || 0);
			const docsEl = document.getElementById('docsInput');
			const documents = docsEl && docsEl.files ? Array.from(docsEl.files).map(f => ({ name: f.name, size: f.size, type: f.type })) : [];
			const record = {
				id,
				name: (data.name || '').trim(),
				ecosystem: data.ecosystem || 'Mangrove',
				location: (data.location || '').trim(),
				status: (data.status || 'Submitted').trim(),
				credits,
				description: (data.description || '').trim(),
				documents,
				createdAt: new Date().toISOString()
			};
			existing.unshift(record);
			localStorage.setItem(projectsKey, JSON.stringify(existing));
			localStorage.setItem('projectJustAdded', record.name);
			window.location.href = 'dashboard.html';
		});
	</script>
</body>
</html>
